<!DOCTYPE html>
<html>
<head>
    <title>Edit Resident</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Flatpickr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</head>

<body>
<div class="container mt-5">

<div class="d-flex justify-content-between align-items-center mb-4">
  <h3 class="mb-0">Edit Resident: {{ resident.first_name }} {{ resident.last_name }}</h3>
  <a href="/" class="btn btn-outline-primary">Home</a>
</div>

<form method="post" action="/edit-resident/{{ resident.id }}">

<!-- ================= PERSONAL DETAILS ================= -->
<div class="card mb-4">
    <div class="card-header">Personal Details</div>
    <div class="card-body">

        <div class="row g-2 mb-3">
            <div class="col-md-3">
                <label class="form-label">First Name</label>
                <input type="hidden" name="first_name" value="{{ resident.first_name }}">
                <input type="text" class="form-control" value="{{ resident.first_name }}" readonly>
            </div>
            <div class="col-md-3">
                <label class="form-label">Last Name</label>
                <input type="hidden" name="last_name" value="{{ resident.last_name }}">
                <input type="text" class="form-control" value="{{ resident.last_name }}" readonly>
            </div>
            <div class="col-md-3">
                <label class="form-label">Date of Birth</label>
                <input type="hidden" name="dob" value="{{ resident.dob }}">
                <input type="text" class="form-control" value="{{ resident.dob }}" readonly>
            </div>
            <div class="col-md-3">
                <label class="form-label">Gender</label>
                <input type="hidden" name="gender" value="{{ resident.gender }}">
                <input type="text" class="form-control" value="{{ resident.gender }}" readonly>
            </div>
        </div>

        <div class="row g-2 mb-3">
            <div class="col-md-4">
                <label class="form-label">Village</label>
                <input type="hidden" name="village" value="{{ resident.village }}">
                <input type="text" class="form-control" value="{{ resident.village }}" readonly>
            </div>
            <div class="col-md-4">
                <label class="form-label">Cellphone No</label>
                <input type="text" name="cellphone_no" class="form-control"
                       value="{{ resident.cellphone_no }}" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Cellphone No 2</label>
                <input type="text" name="cellphone_no2" class="form-control"
                       value="{{ resident.cellphone_no2 or '' }}">
            </div>
        </div>

        <div class="row g-2">
            <div class="col-md-4">
                <label class="form-label">Email</label>
                <input type="email" name="email" class="form-control"
                       value="{{ resident.email or '' }}">
            </div>
        </div>

    </div>
</div>

<!-- ================= EDUCATION ================= -->
<div class="card mb-4">
    <div class="card-header d-flex justify-content-between">
        <span>Education</span>
        <button type="button" class="btn btn-sm btn-secondary" onclick="addEducation()">+ Add</button>
    </div>
    <div class="card-body" id="education-section">

        {% for qualification in resident.qualifications %}
        <div class="row g-2 mb-3 education-row">
            <div class="col-md-3">
                <input name="education_institution[]" class="form-control"
                       value="{{ qualification.institution or '' }}" placeholder="Institution">
            </div>
            <div class="col-md-3">
                <select name="education_name[]" class="form-select" required>
                    <option value="">Name</option>
                    {% for field, names in qualifications.names.items() %}
                        <optgroup label="{{ field }}">
                            {% for name in names %}
                                <option value="{{ name }}"
                                    {% if qualification.name == name %}selected{% endif %}>
                                    {{ name }}
                                </option>
                            {% endfor %}
                        </optgroup>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2">
                <select name="education_type[]" class="form-select" required>
                    <option value="">Type</option>
                    {% for type in qualifications.types %}
                        <option value="{{ type }}"
                            {% if qualification.type == type %}selected{% endif %}>
                            {{ type }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2">
                <select name="education_level[]" class="form-select" required>
                    <option value="">Level</option>
                    {% for level in qualifications.levels %}
                        <option value="{{ level }}"
                            {% if qualification.level == level %}selected{% endif %}>
                            {{ level }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2 d-flex">
                <input name="education_year[]" class="form-control"
                       value="{{ qualification.year or '' }}" placeholder="Year">
                <button type="button" class="btn btn-danger btn-sm ms-2"
                        onclick="deleteEducationRow(this)">✖</button>
            </div>
        </div>
        {% endfor %}

    </div>
</div>

<!-- ================= EXPERIENCE ================= -->
<div class="card mb-4">
    <div class="card-header d-flex justify-content-between">
        <span>Work Experience</span>
        <button type="button" class="btn btn-sm btn-secondary" onclick="addExperience()">+ Add</button>
    </div>
    <div class="card-body" id="experience-section">

        {% for exp in resident.experiences %}
        <div class="row g-2 mb-3 experience-row">
            <div class="col-md-4">
                <input name="company[]" class="form-control"
                       value="{{ exp.company or '' }}" placeholder="Company">
            </div>
            <div class="col-md-4">
                <input name="position[]" class="form-control"
                       value="{{ exp.position or '' }}" placeholder="Position">
            </div>
            <div class="col-md-3">
                <input name="years[]" class="form-control"
                       value="{{ exp.years or '' }}" placeholder="Years">
            </div>
            <div class="col-md-1">
                <button type="button" class="btn btn-danger btn-sm"
                        onclick="deleteExperienceRow(this)">✖</button>
            </div>
        </div>
        {% endfor %}

    </div>
</div>

<!-- ================= SKILLS ================= -->
<div class="card mb-4">
    <div class="card-header d-flex justify-content-between">
        <span>Skills</span>
        <button type="button" class="btn btn-sm btn-secondary" onclick="addSkill()">+ Add</button>
    </div>
    <div class="card-body" id="skills-section">

        {% for skill in resident.skills %}
        <div class="row g-2 mb-3 skill-row">
            <div class="col-md-10">
                <input name="skills[]" class="form-control"
                       value="{{ skill.name or '' }}" placeholder="Skill">
            </div>
            <div class="col-md-2">
                <button type="button" class="btn btn-danger btn-sm"
                        onclick="deleteSkillRow(this)">✖</button>
            </div>
        </div>
        {% endfor %}

    </div>
</div>

<button type="submit" class="btn btn-primary w-100 mb-5">
    Update Resident
</button>

</form>
</div>

<script src="/static/add_resident.js"></script>
</body>
</html>